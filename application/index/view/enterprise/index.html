{extend name="public/common"}
<style>

</style>
{block name="style"}
<title>企业搜索</title>
<style>

    body{
        background-color: #f1f1f1;
    }
    .search{
        background: #f0eff5;
        padding:0.8rem 2.133vw;
        border-bottom: 1px solid #f0eff5;
        position: relative;
        z-index: 999;
    }
    .search>.searchBox{
        border-radius: 0.3rem;
        height:3.2rem;
        background: #ffffff;
        text-align: center;
    }
    .search>.unBtn{
        display: none;
    }
    .search>.searchBox>.searchInput{
        display: none;
    }
    .search>.searchBox>.searchText{
        display: inline-block;
        font-size:1.4rem;
        color: #999;
        padding-left:2.0rem;
        min-width: 1px;
        line-height: 3.2rem;
        height:3.2rem;
        background: url("/index/images/enterprise/search.png") 0 50% no-repeat;
        background-size: 1.4rem 1.4rem;
    }
    .search.isClick{
        background: #ffffff;
        border-bottom: 1px solid #f1f1f1;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .search.isClick>.searchBox{
        background: #f0eff5;
        padding-left: 2.66vw;
        width:78vw;
        display: flex;
        align-items: center;
    }
    .search.isClick>.searchBox>.searchText{
        display: inline-block;
    }
    .search.isClick>.searchBox>.searchText>.searchText_c{
        display: none;
    }
    .search.isClick .searchInput{
        background: #f0eff5;
        display: inline-block;
        font-size:1.4rem;
        height:3.2rem;
        width:61.33vw;
    }
    .search.isClick>.unBtn{
        display: block;
        padding:0;
        box-sizing: border-box;
        width:3.8rem;
        height:2.8rem;
        line-height: 2.8rem;
        border-radius: 5px;
        border:1px solid #5d9cec;
        color: #5d9cec;
        text-align: center;
        font-size: 1.4rem;
    }
    .searchList{
        min-height:100vh;
        /*padding-top:4.4rem;*/
        width:100%;
        background-color: rgba(0,0,0,.5);
        position:absolute;
        top:0;
        left:0;
    }
    .searchList.company-list{
        padding:0;
    }
    .searchList.company-list>li{
        margin-bottom: 0;
        border-bottom: 1px solid #f1f1f1;
    }
    .searchList.bgWhite{
        background-color: rgba(255,255,255,1);
    }
    .searchList>li:first-child{
        margin-top: 4.8rem;
    }
    .company-list{
        padding:0.4rem 3.7333333vw;
    }
    .company-list>li{
        margin-bottom: 0.8rem;
        padding:0.8rem 3.7333333vw;
        display: -webkit-flex;
        display: flex;
        align-items: center;
        background-color: #fff;
    }
    .company-logo>img{
        width:59px;
        height:59px;
        border-radius: 3px;
    }
    .company-list .company-logo{
        margin-right: 1.4rem;
    }
    .company-info>li{
        width:65vw;
        line-height: 2;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .company-info>li:first-child{
        font-size: 1.6rem;
        font-weight: bold;
        color: #333;
    }
    .company-info>li:last-child{
        font-size: 1.2rem;
        color: #999;
    }
    .hidden{
        display: none;
    }
</style>

{/block}

{block name="body"}
<div id="app">
    <div class="search" :class="{isClick:inputStatus}" >
        <div class="searchBox" @click="isClick">
            <div class="searchText"><span class="searchText_c">请在此搜索企业</span></div>
            <input type="text" v-model="inputValue" @keyup="toSearch" class="searchInput" placeholder="请输入企业名" ref="inputF">
        </div>
        <div class="unBtn" @click="isCancel">取消</div>
    </div>
    <!--公司列表-->
    <ul class="company-list" :class="{hidden:inputValue}">
        <li v-for="item in companyList" @click="jumpTo(item.id)">
            <div class="company-logo">
                <img :src="item.img" alt="公司logo" v-if="item.img">
                <img src="/index/images/index/icon-no.png" alt="公司logo" v-else>
            </div>
            <ul class="company-info">
                <li>{{item.name}}</li>
                <li>{{item.mobile}}</li>
            </ul>
        </li>
    </ul>
    <!--搜索列表-->
    <ul class="searchList company-list" :class="{bgWhite:inputValue}" v-if="inputStatus">
        <li v-for="item in searchList" @click="jumpTo(item.id)">
            <div class="company-logo">
                <img :src="item.img" alt="公司logo" v-if="item.img">
                <img src="/index/images/index/icon-no.png" alt="公司logo" v-else>
            </div>
            <ul class="company-info">
                <li>{{item.name}}</li>
                <li>{{item.mobile}}</li>
            </ul>
        </li>
    </ul>
</div>
{/block}

{block name="script"}
<script>
    var app= new Vue({
        el:'#app',
        data:{
            inputStatus:false,
            inputValue:'',
            companyList:JSON.parse('{$list}'),
            searchList:[]
        },
        methods:{
//            getListInfo:function () {
//                this.$http.get('',{params: {}}).then(function (response) {
//                    this.companyList=this.response.data;
//                },function (response) {
//
//                })
//            },
            jumpTo(id){
                window.location.href="/index/enterprise/info/id/"+id;
            },
            isClick:function () {
                this.inputStatus=true;
                this.$refs.inputF.focus();
                console.log(this.$refs.inputF);
            },
            isCancel:function () {
                this.inputStatus=false;
            },
            toSearch:function () {
                let reg=new RegExp(this.inputValue);
                this.searchList=[];
                if(!this.inputValue){
                    this.searchList=[];
                }else{
                    for(let i=0;i<this.companyList.length;i++){
                        if(reg.test(this.companyList[i].name)){
                            this.searchList.push(this.companyList[i])
                        }
                    }
                }
            }
        }
    });


</script>
{/block}